<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <title>Kripto Dashboard — Binance WebSocket</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
  <style>
    :root {
      --bg: #0b0f14;
      --card: #111722;
      --text: #e6edf3;
      --muted: #9fb0c3;
      --up: #16c784;
      --down: #ea3943;
      --border: #1b2432;
      --shadow: 0 8px 24px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box;}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto;}
    header{padding:16px 20px;background:#0b0f14;position:sticky;top:0;z-index:10;border-bottom:1px solid var(--border);}
    header h1{margin:0;font-size:18px;}
    header p{margin:4px 0 0;color:var(--muted);font-size:13px;}
    .grid{display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));padding:14px;}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);padding:12px;display:flex;flex-direction:column;gap:8px;}
    .row{display:flex;align-items:center;justify-content:space-between;}
    .left{display:flex;align-items:center;gap:10px;}
    .logo{width:28px;height:28px;border-radius:50%;background:#0f1520;display:grid;place-items:center;font-weight:bold;font-size:14px;}
    .name{font-weight:600;}
    .sub{color:var(--muted);font-size:12px;}
    .price{font-weight:700;}
    .chg{padding:2px 8px;border-radius:999px;font-size:12px;border:1px solid var(--border);}
    .chg.up{color:var(--up);background:rgba(22,199,132,.08);}
    .chg.down{color:var(--down);background:rgba(234,57,67,.08);}
    .chart{width:100%;height:140px;border-radius:8px;overflow:hidden;}
  </style>
</head>
<body>
<header>
  <h1>Kripto Dashboard</h1>
  <p>Gerçek zamanlı Binance WebSocket verisi — Lightweight Charts</p>
</header>
<main class="grid" id="grid"></main>

<script>
const ASSETS=[
 {key:"BTCUSDT",label:"BTC/USDT",icon:"₿"},
 {key:"ETHUSDT",label:"ETH/USDT",icon:"◆"},
 {key:"XRPUSDT",label:"XRP/USDT",icon:"✕"},
 {key:"XLMUSDT",label:"XLM/USDT",icon:"★"},
 {key:"QNTUSDT",label:"QNT/USDT",icon:"Ɋ"},
 {key:"HBARUSDT",label:"HBAR/USDT",icon:"Ḧ"},
 {key:"ALGOUSDT",label:"ALGO/USDT",icon:"Λ"},
 {key:"PAXGUSDT",label:"PAXG/USDT",icon:"◎"},
 {key:"USDTTRY",label:"USD/TRY*",icon:"₺"},
];
const grid=document.getElementById("grid");
const cards={};
ASSETS.forEach(a=>{
 const card=document.createElement("section");
 card.className="card";
 const top=document.createElement("div");top.className="row";
 const left=document.createElement("div");left.className="left";
 const logo=document.createElement("div");logo.className="logo";logo.textContent=a.icon;
 const names=document.createElement("div");
 const n1=document.createElement("div");n1.className="name";n1.textContent=a.label;
 const n2=document.createElement("div");n2.className="sub";n2.textContent=a.key;
 names.append(n1,n2);left.append(logo,names);
 const right=document.createElement("div");right.style.textAlign="right";
 const price=document.createElement("div");price.className="price";price.textContent="—";
 const chg=document.createElement("div");chg.className="chg";chg.textContent="—";
 right.append(price,chg);top.append(left,right);
 const chartEl=document.createElement("div");chartEl.className="chart";
 card.append(top,chartEl);grid.append(card);
 const chart=LightweightCharts.createChart(chartEl,{layout:{background:{color:"transparent"},textColor:"#ccc"},grid:{vertLines:{color:"#1b2432"},horzLines:{color:"#1b2432"}},timeScale:{timeVisible:true}});
 const candle=chart.addCandlestickSeries({upColor:"#16c784",downColor:"#ea3943",borderVisible:false,wickUpColor:"#16c784",wickDownColor:"#ea3943"});
 cards[a.key]={card,chart,candle,price,chg};
});
const fmt=p=>Number(p).toLocaleString("tr-TR",{maximumFractionDigits:p>1?2:6});
function setChange(el,p){el.classList.remove("up","down");if(p>0)el.classList.add("up");if(p<0)el.classList.add("down");el.textContent=(p>0?"+":"")+p.toFixed(2)+"%";}
async function init(){
 for(const a of ASSETS){
  const k=await fetch(`https://api.binance.com/api/v3/klines?symbol=${a.key}&interval=1m&limit=200`).then(r=>r.json());
  const d=k.map(v=>({time:v[0]/1000,open:+v[1],high:+v[2],low:+v[3],close:+v[4]}));
  cards[a.key].candle.setData(d);
  const t=await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${a.key}`).then(r=>r.json());
  const lp=+t.lastPrice,pc=+t.priceChangePercent;
  cards[a.key].price.textContent=fmt(lp);setChange(cards[a.key].chg,pc);
 }
 const streams=ASSETS.flatMap(a=>[`${a.key.toLowerCase()}@kline_1m`,`${a.key.toLowerCase()}@ticker`]).join("/");
 const ws=new WebSocket(`wss://stream.binance.com:9443/stream?streams=${streams}`);
 ws.onmessage=e=>{
  const m=JSON.parse(e.data),s=m.stream,d=m.data;
  if(s.includes("@kline")){const c=d.k;cards[d.s]?.candle.update({time:c.t/1000,open:+c.o,high:+c.h,low:+c.l,close:+c.c});cards[d.s].price.textContent=fmt(c.c);}
  else if(s.includes("@ticker")){const p=+d.c,pc=+d.P;cards[d.s]?.price&&(cards[d.s].price.textContent=fmt(p));setChange(cards[d.s].chg,pc);}
 };
}
init();
</script>
</body>
</html>
